% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gen_priorG2.R
\name{gen_priorG2}
\alias{gen_priorG2}
\title{Generate Site-Specific Treatment Effects from a Prior Distribution}
\usage{
gen_priorG2(
  true_dist,
  J = 50,
  sigma_tau = 0.25,
  tau = 0,
  variance = 1,
  nu = NULL,
  slant = NULL,
  rho = NULL,
  delta = NULL,
  eps = NULL,
  ups = NULL,
  formula = NULL,
  beta = NULL,
  data = NULL,
  seed = 123,
  set_seed = TRUE
)
}
\arguments{
\item{true_dist}{A character string specifying the type of distribution to use.
Options are \code{"Gaussian"}, \code{"T"}, \code{"Skew"}, \code{"ALD"}, or \code{"Mixture"}.}

\item{J}{A positive integer indicating the number of sites (default: 50). If \code{formula}
and \code{data} are provided, then \code{J} must match \code{nrow(data)}
(or be explicitly set to that).}

\item{sigma_tau}{A positive number to scale the generated treatment effects (default: 0.25).}

\item{tau}{A numeric value specifying an overall offset for the site means (default: 0).}

\item{variance}{A positive number specifying the baseline variance for the distribution (default: 1).}

\item{nu}{Degrees of freedom for the T distribution. Must be provided if \code{true_dist = "T"}.}

\item{slant}{A numeric value for the skew parameter in the Skew Normal distribution.
Must be provided if \code{true_dist = "Skew"}.}

\item{rho}{A numeric value for the parameter in the Asymmetric Laplace distribution (ALD).
Must be provided if \code{true_dist = "ALD"}.}

\item{delta}{A numeric value for the Mixture distribution (must be provided if \code{true_dist = "Mixture"}).}

\item{eps}{A numeric value (typically between 0 and 1) for the Mixture distribution.}

\item{ups}{A positive numeric value for the Mixture distribution.}

\item{formula}{An optional model formula describing how covariates in \code{data} should be used
to form the design matrix. For example, \code{~ X1 + X2} or \code{~ 0 + X1 + X2}.
If provided, you must also supply \code{beta} and \code{data}.}

\item{beta}{A numeric vector of regression coefficients corresponding to the columns of
\code{model.matrix(formula, data)}. If \code{formula} is provided,
\code{beta} must have length equal to \code{ncol(model.matrix(...))}.}

\item{data}{An optional data frame containing site-level covariates to be used in \code{formula}.
Must have \code{nrow(data) == J} if provided.}

\item{seed}{An optional integer for setting the random seed (default: 123). If \code{NULL}, no seed is set.}

\item{set_seed}{Logical indicating whether to call \code{set.seed(seed)} (default: TRUE).}
}
\value{
A \strong{data frame} with \code{J} rows. It always contains
\code{site_index} and \code{site_effect}, plus covariate columns if you provided them.
Covariates appear to the \emph{right} of these two columns.
}
\description{
This function generates site-specific treatment effects based on the specified
distribution and parameters. The generated values are then scaled by \code{sigma_tau}.
}
\details{
You can specify site-level covariates in two ways:
\enumerate{
\item Provide a \code{formula} and a \code{data} frame, which will be processed via
\code{model.matrix}. The resulting design matrix is multiplied by \code{beta}
to shift each site's mean.
\item Or simply set \code{tau} if you want a constant baseline mean with no additional covariates.
}

The final site-specific means are
\code{site_means = tau + model_matrix \%*\% beta} (if \code{formula} is provided),
or simply \code{rep(tau, J)} if no \code{formula} and \code{beta} are given.
Then, for each site, a value is drawn from the chosen distribution
(e.g. Gaussian, T, skew-normal, etc.) with that mean and variance \code{variance}.
Finally, all values are multiplied by \code{sigma_tau}.

The function \strong{returns a data frame} with:
\itemize{
\item \code{site_index} (integer from \eqn{1} to \eqn{J})
\item \code{site_effect} (the generated treatment effect for each site)
\item If \code{formula} and \code{data} were provided, all original covariate columns
appear to the \emph{right} of \code{site_effect}.
\item Otherwise, only \code{site_index} and \code{site_effect}.
}
}
\examples{
\dontrun{
  ##################################################
  # Example 1) No covariates, Gaussian distribution
  ##################################################
  # A simple example: 5 sites, baseline mean=2, variance=1
  effects1_df <- gen_priorG2("Gaussian", J = 5, tau = 2, variance = 1)
  effects1_df

  # Another distribution with no covariates:
  # "T" distribution, df=5, variance=2
  effectsT_df <- gen_priorG2("T", J=6, nu=5, variance=2)
  effectsT_df

  # Or "Mixture" (a simple 2-component mixture):
  effMix_df <- gen_priorG2("Mixture", J=6, delta=0.5, eps=0.3, ups=1.0)
  effMix_df

  ##################################################
  # Example 2) Covariates: binomial random X1,X2,X3
  ##################################################
  # Suppose we have 100 sites
  J <- 100
  p1 <- 0.5
  p2 <- 0.3
  p3 <- 0.7

  X1 <- rbinom(J, size=1, prob=p1)
  X2 <- rbinom(J, size=1, prob=p2)
  X3 <- rbinom(J, size=1, prob=p3)

  # Put covariates in a data.frame
  site_data <- data.frame(X1 = X1, X2 = X2, X3 = X3)

  # formula = ~ X1 + X2 + X3 => design matrix has 4 columns: Intercept + X1 + X2 + X3
  beta_vec <- c(2, 1.5, -1, 0.5)
    # Intercept=2, X1=1.5, X2=-1, X3=0.5

  # Now generate site effects from e.g. "Gaussian"
  effCov_df <- gen_priorG2(
    true_dist = "Gaussian",
    J         = J,
    formula   = ~ X1 + X2 + X3,
    beta      = beta_vec,
    data      = site_data,
    variance  = 1,
    sigma_tau = 0.5
  )
  head(effCov_df)
  # We see site_index, site_effect, then X1, X2, X3
}

}
